!function(){"use strict";let e=[],t=!1,i=!1;function s(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function n(e){return e[e.length-1]}function r(e,...t){return t.forEach((t=>{e.includes(t)||e.push(t)})),e}function a(e,t){return e?e.split(t):[]}function o(e,t,i){return(void 0===t||e>=t)&&(void 0===i||e<=i)}function d(e,t,i){return e<t?t:e>i?i:e}function c(e,t,i={},s=0,n=""){n+=`<${Object.keys(i).reduce(((e,t)=>{let n=i[t];return"function"==typeof n&&(n=n(s)),`${e} ${t}="${n}"`}),e)}></${e}>`;const r=s+1;return r<t?c(e,t,i,r,n):n}function l(e){return e.replace(/>\s+/g,">").replace(/\s{1,100}</,"<")}function h(e){return new Date(e).setHours(0,0,0,0)}function u(){return(new Date).setHours(0,0,0,0)}function p(...e){switch(e.length){case 0:return u();case 1:return h(e[0])}const t=new Date(0);return t.setFullYear(...e),t.setHours(0,0,0,0)}function f(e,t){const i=new Date(e);return i.setDate(i.getDate()+t)}function k(e,t){const i=new Date(e),s=i.getMonth()+t;let n=s%12;n<0&&(n+=12);const r=i.setMonth(s);return i.getMonth()!==n?i.setDate(0):r}function w(e,t){const i=new Date(e),s=i.getMonth(),n=i.setFullYear(i.getFullYear()+t);return 1===s&&2===i.getMonth()?i.setDate(0):n}function y(e,t){return(e-t+7)%7}function g(e,t,i=0){const s=new Date(e).getDay();return f(e,y(t,i)-y(s,i))}function v(e,t){const i=new Date(e).getFullYear();return Math.floor(i/t)*t}function b(e,t,i){if(1!==t&&2!==t)return e;const s=new Date(e);return 1===t?i?s.setMonth(s.getMonth()+1,0):s.setDate(1):i?s.setFullYear(s.getFullYear()+1,0,0):s.setMonth(0,1),s.setHours(0,0,0,0)}const m=/dd?|DD?|mm?|MM?|yy?(?:yy)?/,D=/[\s!-/:-@[-`{-~年月日]+/;let x={};const E={y:(e,t)=>new Date(e).setFullYear(parseInt(t,10)),m(e,t,i){const s=new Date(e);let n=parseInt(t,10)-1;if(isNaN(n)){if(!t)return NaN;const e=t.toLowerCase(),s=t=>t.toLowerCase().startsWith(e);if(n=i.monthsShort.findIndex(s),n<0&&(n=i.months.findIndex(s)),n<0)return NaN}return s.setMonth(n),s.getMonth()!==S(n)?s.setDate(0):s.getTime()},d:(e,t)=>new Date(e).setDate(parseInt(t,10))},L={d:e=>e.getDate(),dd:e=>A(e.getDate(),2),D:(e,t)=>t.daysShort[e.getDay()],DD:(e,t)=>t.days[e.getDay()],m:e=>e.getMonth()+1,mm:e=>A(e.getMonth()+1,2),M:(e,t)=>t.monthsShort[e.getMonth()],MM:(e,t)=>t.months[e.getMonth()],y:e=>e.getFullYear(),yy:e=>A(e.getFullYear(),2).slice(-2),yyyy:e=>A(e.getFullYear(),4)};function S(e){return e>-1?e%12:S(e+12)}function A(e,t){return e.toString().padStart(t,"0")}function M(e){if("string"!=typeof e)throw new Error("Invalid date format.");if(e in x)return x[e];const t=e.split(m),i=e.match(new RegExp(m,"g"));if(0===t.length||!i)throw new Error("Invalid date format.");const s=i.map((e=>L[e])),r=Object.keys(E).reduce(((e,t)=>(i.find((e=>"D"!==e[0]&&e[0].toLowerCase()===t))&&e.push(t),e)),[]);return x[e]={parser(e,t){const s=e.split(D).reduce(((e,t,s)=>{if(t.length>0&&i[s]){const n=i[s][0];"M"===n?e.m=t:"D"!==n&&(e[n]=t)}return e}),{});return r.reduce(((e,i)=>{const n=E[i](e,s[i],t);return isNaN(n)?e:n}),u())},formatter:(e,i)=>s.reduce(((s,n,r)=>s+=`${t[r]}${n(e,i)}`),"")+n(t)}}function F(e,t,i){if(e instanceof Date||"number"==typeof e){const t=h(e);return isNaN(t)?void 0:t}if(e){if("today"===e)return u();if(t&&t.toValue){const s=t.toValue(e,t,i);return isNaN(s)?void 0:h(s)}return M(t).parser(e,i)}}function B(e,t,i){if(isNaN(e)||!e&&0!==e)return"";const s="number"==typeof e?new Date(e):e;return t.toDisplay?t.toDisplay(s,t,i):M(t).formatter(s,i)}const C=document.createRange();function O(e){return C.createContextualFragment(e)}function N(e){return e.parentElement||(e.parentNode instanceof ShadowRoot?e.parentNode.host:void 0)}function K(e){return e.getRootNode().activeElement===e}function V(e){"none"!==e.style.display&&(e.style.display&&(e.dataset.styleDisplay=e.style.display),e.style.display="none")}function W(e){"none"===e.style.display&&(e.dataset.styleDisplay?(e.style.display=e.dataset.styleDisplay,delete e.dataset.styleDisplay):e.style.display="")}function Y(e){e.firstChild&&(e.removeChild(e.firstChild),Y(e))}const T=new WeakMap,{addEventListener:P,removeEventListener:R}=EventTarget.prototype;function H(e,t){let i=T.get(e);i||(i=[],T.set(e,i)),t.forEach((e=>{P.call(...e),i.push(e)}))}function j(e){let t=T.get(e);t&&(t.forEach((e=>{R.call(...e)})),T.delete(e))}if(!Event.prototype.composedPath){const e=(t,i=[])=>{let s;return i.push(t),t.parentNode?s=t.parentNode:t.host?s=t.host:t.defaultView&&(s=t.defaultView),s?e(s,i):i};Event.prototype.composedPath=function(){return e(this.target)}}function $(e,t,i){const[s,...n]=e;return t(s)?s:s!==i&&"HTML"!==s.tagName&&0!==n.length?$(n,t,i):void 0}function _(e,t){const i="function"==typeof t?t:e=>e instanceof Element&&e.matches(t);return $(e.composedPath(),i,e.currentTarget)}const U={en:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],today:"Today",clear:"Clear",titleFormat:"MM y",monthsTitle:"Months",weekStart:1,format:"dd/mm/yyyy",btnMonth:"Change the month",btnPrevMonth:"Previous month",btnNextMonth:"Next month",btnYear:"Change the year",btnPrevYear:"Previous year",btnNextYear:"Next year",btnDecade:"Change the decade",btnPrevDecade:"Previous decade",btnNextDecade:"Next decade",btnPrevCentury:"Previous century",btnNextCentury:"Next century"},it:{days:["Domenica","Lunedì","Martedì","Mercoledì","Giovedì","Venerdì","Sabato"],daysShort:["Dom","Lun","Mar","Mer","Gio","Ven","Sab"],daysMin:["Do","Lu","Ma","Me","Gi","Ve","Sa"],months:["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"],monthsShort:["Gen","Feb","Mar","Apr","Mag","Giu","Lug","Ago","Set","Ott","Nov","Dic"],today:"Oggi",monthsTitle:"Mesi",clear:"Cancella",weekStart:1,format:"dd/mm/yyyy",btnMonth:"Cambia il mese",btnPrevMonth:"Mese precedente",btnNextMonth:"Mese successivo",btnYear:"Cambia l'anno",btnPrevYear:"Anno precedente",btnNextYear:"Anno successivo",btnDecade:"Cambia il decennio",btnPrevDecade:"Decennio precedente",btnNextDecade:"Decennio successivo",btnPrevCentury:"Secolo precedente",btnNextCentury:"Secolo successivo"}},I={autohide:!1,beforeShowDay:null,beforeShowDecade:null,beforeShowMonth:null,beforeShowYear:null,calendarWeeks:!1,clearBtn:!1,dateDelimiter:",",datesDisabled:[],daysOfWeekDisabled:[],daysOfWeekHighlighted:[],defaultViewDate:void 0,disableTouchKeyboard:!1,format:"mm/dd/yyyy",getCalendarWeek:null,language:"en",maxDate:null,maxNumberOfDates:1,maxView:3,minDate:null,nextArrow:"»",orientation:"auto",pickLevel:0,prevArrow:"«",showDaysOfWeek:!0,showOnClick:!0,showOnFocus:!0,startView:0,title:"",todayBtn:!1,todayBtnMode:0,todayHighlight:!1,updateOnBlur:!0,weekStart:0},{language:q,format:G,weekStart:J}=I;function z(e,t){return e.length<6&&t>=0&&t<7?r(e,t):e}function X(e){return(e+6)%7}function Q(e,t,i,s){const n=F(e,t,i);return void 0!==n?n:s}function Z(e,t,i=3){const s=parseInt(e,10);return s>=0&&s<=i?s:t}function ee(e,t){const i=Object.assign({},e),n={},a=t.constructor.locales,o=t.rangeSideIndex;let{format:d,getCalendarWeek:c,language:l,locale:h,maxDate:u,maxView:f,minDate:k,pickLevel:w,startView:y,weekStart:g}=t.config||{};if(i.language){let e;if(i.language!==l&&(a[i.language]?e=i.language:(e=i.language.split("-")[0],void 0===a[e]&&(e=!1))),delete i.language,e){l=n.language=e;const t=h||a[q];h=Object.assign({format:G,weekStart:J},a[q]),l!==q&&Object.assign(h,a[l]),n.locale=h,d===t.format&&(d=n.format=h.format),g===t.weekStart&&(g=n.weekStart=h.weekStart,n.weekEnd=X(h.weekStart))}}if(i.format){const e="function"==typeof i.format.toDisplay,t="function"==typeof i.format.toValue,s=m.test(i.format);(e&&t||s)&&(d=n.format=i.format),delete i.format}let v=w;void 0!==i.pickLevel&&(v=Z(i.pickLevel,2),delete i.pickLevel),v!==w&&(v>w&&(void 0===i.minDate&&(i.minDate=k),void 0===i.maxDate&&(i.maxDate=u)),i.datesDisabled||(i.datesDisabled=[]),w=n.pickLevel=v);let D=k,x=u;if(void 0!==i.minDate){const e=p(0,0,1);D=null===i.minDate?e:Q(i.minDate,d,h,D),D!==e&&(D=b(D,w,!1)),delete i.minDate}if(void 0!==i.maxDate&&(x=null===i.maxDate?void 0:Q(i.maxDate,d,h,x),void 0!==x&&(x=b(x,w,!0)),delete i.maxDate),x<D?(k=n.minDate=x,u=n.maxDate=D):(k!==D&&(k=n.minDate=D),u!==x&&(u=n.maxDate=x)),i.datesDisabled&&(n.datesDisabled=i.datesDisabled.reduce(((e,t)=>{const i=F(t,d,h);return void 0!==i?r(e,b(i,w,o)):e}),[]),delete i.datesDisabled),void 0!==i.defaultViewDate){const e=F(i.defaultViewDate,d,h);void 0!==e&&(n.defaultViewDate=e),delete i.defaultViewDate}if(void 0!==i.weekStart){const e=Number(i.weekStart)%7;isNaN(e)||(g=n.weekStart=e,n.weekEnd=X(e)),delete i.weekStart}if(i.daysOfWeekDisabled&&(n.daysOfWeekDisabled=i.daysOfWeekDisabled.reduce(z,[]),delete i.daysOfWeekDisabled),i.daysOfWeekHighlighted&&(n.daysOfWeekHighlighted=i.daysOfWeekHighlighted.reduce(z,[]),delete i.daysOfWeekHighlighted),void 0!==i.maxNumberOfDates){const e=parseInt(i.maxNumberOfDates,10);e>=0&&(n.maxNumberOfDates=e,n.multidate=1!==e),delete i.maxNumberOfDates}i.dateDelimiter&&(n.dateDelimiter=String(i.dateDelimiter),delete i.dateDelimiter);let E=f;void 0!==i.maxView&&(E=Z(i.maxView,f),delete i.maxView),E=w>E?w:E,E!==f&&(f=n.maxView=E);let L=y;if(void 0!==i.startView&&(L=Z(i.startView,L),delete i.startView),L<w?L=w:L>f&&(L=f),L!==y&&(n.startView=L),i.prevArrow){const e=O(i.prevArrow);e.childNodes.length>0&&(n.prevArrow=e.childNodes),delete i.prevArrow}if(i.nextArrow){const e=O(i.nextArrow);e.childNodes.length>0&&(n.nextArrow=e.childNodes),delete i.nextArrow}if(void 0!==i.disableTouchKeyboard&&(n.disableTouchKeyboard="ontouchstart"in document&&!!i.disableTouchKeyboard,delete i.disableTouchKeyboard),i.orientation){const e=i.orientation.toLowerCase().split(/\s+/g);n.orientation={x:e.find((e=>"left"===e||"right"===e))||"auto",y:e.find((e=>"top"===e||"bottom"===e))||"auto"},delete i.orientation}if(void 0!==i.todayBtnMode){switch(i.todayBtnMode){case 0:case 1:n.todayBtnMode=i.todayBtnMode}delete i.todayBtnMode}return n.getCalendarWeek="function"==typeof i.getCalendarWeek?i.getCalendarWeek:c||null,delete i.getCalendarWeek,Object.keys(i).forEach((e=>{void 0!==i[e]&&s(I,e)&&(n[e]=i[e])})),n}const te=l('<div class="datepicker" aria-hidden="true">\n  <div class="datepicker-picker">\n    <div class="datepicker-header">\n      <div class="datepicker-title"></div>\n      <div class="datepicker-controls">\n        <button type="button" class="%buttonClass% prev-btn"></button>\n        <button type="button" class="%buttonClass% view-switch"></button>\n        <button type="button" class="%buttonClass% next-btn"></button>\n      </div>\n    </div>\n    <div class="datepicker-main"></div>\n    <div class="datepicker-footer">\n      <div class="datepicker-controls">\n        <button type="button" class="%buttonClass% today-btn"></button>\n        <button type="button" class="%buttonClass% clear-btn"></button>\n      </div>\n    </div>\n  </div>\n</div>'),ie=l(`<div class="days">\n  <div class="days-of-week">${c("span",7,{class:"dow"})}</div>\n  <div class="datepicker-grid">${c("span",42)}</div>\n</div>`),se=l(`<div class="calendar-weeks">\n  <div class="days-of-week"><span class="dow"></span></div>\n  <div class="weeks">${c("span",6,{class:"week"})}</div>\n</div>`);class ne{constructor(e,t){Object.assign(this,t,{picker:e,element:O('<div class="datepicker-view"></div>').firstChild,selected:[]}),this.init(this.picker.datepicker.config)}init(e){void 0!==e.pickLevel&&(this.isMinView=this.id===e.pickLevel),this.setOptions(e),this.updateFocus(),this.updateSelection()}performBeforeHook(e,t,i){let s=this.beforeShow(new Date(i));switch(typeof s){case"boolean":s={enabled:s};break;case"string":s={classes:s}}if(s){if(!1===s.enabled&&(e.classList.add("disabled"),r(this.disabled,t)),s.classes){const i=s.classes.split(/\s+/);e.classList.add(...i),i.includes("disabled")&&r(this.disabled,t)}s.content&&function(e,t){Y(e),t instanceof DocumentFragment?e.appendChild(t):"string"==typeof t?e.appendChild(O(t)):"function"==typeof t.forEach&&t.forEach((t=>{e.appendChild(t)}))}(e,s.content)}}}class re extends ne{constructor(t){super(t,{id:0,name:"days",cellClass:"day"}),this.picker=t,this.inputField=this.picker.datepicker.element,this.picker.controls.prevBtn.setAttribute("tabindex","0"),this.picker.controls.nextBtn.setAttribute("tabindex","0"),this.picker.controls.viewSwitch.setAttribute("tabindex","0"),this.prevBtnListener=e=>{if("Tab"==e.key)if(e.preventDefault(),e.shiftKey){const e=Math.round((this.focused-this.start)/864e5);this.grid.children[e].focus()}else this.picker.controls.viewSwitch.focus();else"ArrowLeft"==e.key||"ArrowUp"==e.key||"ArrowDown"==e.key||"ArrowRight"==e.key?e.preventDefault():"Escape"==e.key&&(e.preventDefault(),this.picker.datepicker.inputField.focus(),this.picker.hide(),Pe(this.picker.datepicker,2))},this.viewSwitchListener=t=>{if("Tab"==t.key)t.preventDefault(),t.shiftKey?this.picker.controls.prevBtn.focus():this.picker.controls.nextBtn.focus();else if("Enter"==t.key){for(let t=0;t<e.length;t++)e[t][0].removeEventListener(e[t][1],e[t][2]);e=[]}else"ArrowLeft"==t.key||"ArrowUp"==t.key||"ArrowDown"==t.key||"ArrowRight"==t.key?t.preventDefault():"Escape"==t.key&&(t.preventDefault(),this.picker.datepicker.inputField.focus(),this.picker.hide(),Pe(this.picker.datepicker,2))},this.nextBtnListener=e=>{if("Tab"==e.key)if(e.preventDefault(),e.shiftKey)this.picker.controls.viewSwitch.focus();else{const e=Math.round((this.focused-this.start)/864e5);this.grid.children[e].focus()}else"ArrowLeft"==e.key||"ArrowUp"==e.key||"ArrowDown"==e.key||"ArrowRight"==e.key?e.preventDefault():"Escape"==e.key&&(e.preventDefault(),this.picker.datepicker.inputField.focus(),this.picker.hide(),Pe(this.picker.datepicker,2))},this.dateKeyListener=e=>{switch(e.preventDefault(),e.key){case"ArrowLeft":this.inputField.focus(),this.inputField.dispatchEvent(new KeyboardEvent("keydown",{key:"ArrowLeft"}));break;case"ArrowRight":this.inputField.focus(),this.inputField.dispatchEvent(new KeyboardEvent("keydown",{key:"ArrowRight"}));break;case"ArrowUp":this.inputField.focus(),this.inputField.dispatchEvent(new KeyboardEvent("keydown",{key:"ArrowUp"}));break;case"ArrowDown":this.inputField.focus(),this.inputField.dispatchEvent(new KeyboardEvent("keydown",{key:"ArrowDown"}));break;case"Enter":this.inputField.focus(),this.inputField.dispatchEvent(new KeyboardEvent("keydown",{key:"Enter"})),e.target.focus();break;case"Escape":this.inputField.focus(),this.inputField.dispatchEvent(new KeyboardEvent("keydown",{key:"Escape"}));break;case"Tab":if(e.shiftKey){this.picker.controls.nextBtn.focus();break}this.picker.controls.prevBtn.focus()}}}init(e,t=!0){if(t){const e=O(ie).firstChild;this.dow=e.firstChild,this.grid=e.lastChild,this.element.appendChild(e)}super.init(e)}setOptions(e){let t;if(s(e,"minDate")&&(this.minDate=e.minDate),s(e,"maxDate")&&(this.maxDate=e.maxDate),e.datesDisabled&&(this.datesDisabled=e.datesDisabled),e.daysOfWeekDisabled&&(this.daysOfWeekDisabled=e.daysOfWeekDisabled,t=!0),e.daysOfWeekHighlighted&&(this.daysOfWeekHighlighted=e.daysOfWeekHighlighted),void 0!==e.todayHighlight&&(this.todayHighlight=e.todayHighlight),void 0!==e.weekStart&&(this.weekStart=e.weekStart,this.weekEnd=e.weekEnd,t=!0),e.locale){const i=this.locale=e.locale;this.dayNames=i.daysMin,this.switchLabelFormat=i.titleFormat,t=!0}if(void 0!==e.beforeShowDay&&(this.beforeShow="function"==typeof e.beforeShowDay?e.beforeShowDay:void 0),void 0!==e.calendarWeeks)if(e.calendarWeeks&&!this.calendarWeeks){const e=O(se).firstChild;this.calendarWeeks={element:e,dow:e.firstChild,weeks:e.lastChild},this.element.insertBefore(e,this.element.firstChild)}else this.calendarWeeks&&!e.calendarWeeks&&(this.element.removeChild(this.calendarWeeks.element),this.calendarWeeks=null);"function"==typeof e.getCalendarWeek&&(this.getCalendarWeek=e.getCalendarWeek),void 0!==e.showDaysOfWeek&&(e.showDaysOfWeek?(W(this.dow),this.calendarWeeks&&W(this.calendarWeeks.dow)):(V(this.dow),this.calendarWeeks&&V(this.calendarWeeks.dow))),t&&Array.from(this.dow.children).forEach(((e,t)=>{const i=(this.weekStart+t)%7;e.textContent=this.dayNames[i],e.className=this.daysOfWeekDisabled.includes(i)?"dow disabled":"dow"}))}updateFocus(){const e=new Date(this.picker.viewDate),t=e.getFullYear(),i=e.getMonth(),s=p(t,i,1),n=g(s,this.weekStart,this.weekStart);this.first=s,this.last=p(t,i+1,0),this.start=n,this.focused=this.picker.viewDate}updateSelection(){const{dates:e,rangepicker:t}=this.picker.datepicker;this.selected=e,t&&(this.range=t.dates)}updateControlsListeners(){this.picker.controls.prevBtn.addEventListener("keydown",this.prevBtnListener),e.push([this.picker.controls.prevBtn,"keydown",this.prevBtnListener]),this.picker.controls.viewSwitch.addEventListener("keydown",this.viewSwitchListener),e.push([this.picker.controls.viewSwitch,"keydown",this.viewSwitchListener]),this.picker.controls.nextBtn.addEventListener("keydown",this.nextBtnListener),e.push([this.picker.controls.nextBtn,"keydown",this.nextBtnListener])}render(){this.today=this.todayHighlight?u():void 0,this.disabled=[...this.datesDisabled];const e=B(this.focused,this.switchLabelFormat,this.locale);if(this.picker.setViewSwitchLabel(e),this.picker.setPrevBtnDisabled(this.first<=this.minDate),this.picker.setNextBtnDisabled(this.last>=this.maxDate),this.picker.controls.prevBtn.setAttribute("aria-label",this.picker.datepicker.config.locale.btnPrevMonth),this.picker.controls.nextBtn.setAttribute("aria-label",this.picker.datepicker.config.locale.btnNextMonth),this.picker.controls.viewSwitch.setAttribute("aria-label",this.picker.datepicker.config.locale.btnMonth),this.calendarWeeks){const e=g(this.first,1,this.weekStart),t=(e,t)=>this.getCalendarWeek?this.getCalendarWeek(new Date(e),t):function(e){const t=g(e,4,1),i=g(new Date(t).setMonth(0,4),4,1);return Math.round((t-i)/6048e5)+1}(e);Array.from(this.calendarWeeks.weeks.children).forEach(((i,s)=>{i.textContent=t(f(e,7*s),this.weekStart)}))}Array.from(this.grid.children).forEach(((e,s)=>{const n=e.classList,a=f(this.start,s),o=new Date(a),d=o.getDay();if(e.className=`datepicker-cell ${this.cellClass}`,e.title=`${this.picker.datepicker.config.locale.days[d]} ${o.getDate()} ${this.picker.datepicker.config.locale.months[o.getMonth()]} ${o.getFullYear()}`,e.setAttribute("aria-label",`${e.title}`),e.setAttribute("role","button"),e.dataset.date=a,e.textContent=o.getDate(),a<this.first?n.add("prev"):a>this.last&&n.add("next"),this.today===a&&n.add("today"),(a<this.minDate||a>this.maxDate||this.disabled.includes(a))&&n.add("disabled"),this.daysOfWeekDisabled.includes(d)&&(n.add("disabled"),r(this.disabled,a)),this.daysOfWeekHighlighted.includes(d)&&n.add("highlighted"),this.range){const[e,t]=this.range;a>e&&a<t&&n.add("range"),a===e&&n.add("range-start"),a===t&&n.add("range-end")}this.selected.includes(a)&&n.add("selected"),a===this.focused&&(n.add("focused"),e.setAttribute("tabindex","0"),e.focus(),t&&(this.picker.controls.prevBtn.focus(),t=!1),i&&(this.picker.controls.nextBtn.focus(),i=!1),e.addEventListener("keydown",this.dateKeyListener),this.updateControlsListeners()),this.beforeShow&&this.performBeforeHook(e,a,a)}))}refresh(){const[e,t]=this.range||[];this.grid.querySelectorAll(".range, .range-start, .range-end, .selected, .focused").forEach((e=>{e.classList.remove("range","range-start","range-end","selected","focused")})),Array.from(this.grid.children).forEach((i=>{const s=Number(i.dataset.date),n=i.classList;s>e&&s<t&&n.add("range"),s===e&&n.add("range-start"),s===t&&n.add("range-end"),this.selected.includes(s)&&n.add("selected"),s===this.focused&&n.add("focused")}))}refreshFocus(){const e=Math.round((this.focused-this.start)/864e5);this.grid.querySelectorAll(".focused").forEach((e=>{e.classList.remove("focused"),e.removeAttribute("tabindex"),e.removeEventListener("keydown",this.dateKeyListener)})),this.grid.children[e].classList.add("focused"),this.grid.children[e].setAttribute("tabindex","0"),this.grid.children[e].focus(),this.grid.children[e].addEventListener("keydown",this.dateKeyListener)}}function ae(e,t){if(!e||!e[0]||!e[1])return;const[[i,s],[n,r]]=e;return i>t||n<t?void 0:[i===t?s:-1,n===t?r:12]}class oe extends ne{constructor(t){super(t,{id:1,name:"months",cellClass:"month"}),this.inputField=this.picker.datepicker.element,this.prevBtnListener=e=>{"Tab"==e.key?(e.preventDefault(),e.shiftKey?this.grid.children[this.focused].focus():this.picker.controls.viewSwitch.focus()):"ArrowLeft"==e.key||"ArrowUp"==e.key||"ArrowDown"==e.key||"ArrowRight"==e.key?e.preventDefault():"Escape"==e.key&&(e.preventDefault(),this.picker.datepicker.inputField.focus(),this.picker.hide(),Pe(this.picker.datepicker,2))},this.viewSwitchListener=t=>{if("Tab"==t.key)t.preventDefault(),t.shiftKey?this.picker.controls.prevBtn.focus():this.picker.controls.nextBtn.focus();else if("Enter"==t.key){for(let t=0;t<e.length;t++)e[t][0].removeEventListener(e[t][1],e[t][2]);e=[]}else"Escape"==t.key&&(t.preventDefault(),this.picker.datepicker.inputField.focus(),this.picker.hide(),Pe(this.picker.datepicker,2))},this.nextBtnListener=e=>{"Tab"==e.key?(e.preventDefault(),e.shiftKey?this.picker.controls.viewSwitch.focus():this.grid.children[this.focused].focus()):"ArrowLeft"==e.key||"ArrowUp"==e.key||"ArrowDown"==e.key||"ArrowRight"==e.key?e.preventDefault():"Escape"==e.key&&(e.preventDefault(),this.picker.datepicker.inputField.focus(),this.picker.hide(),Pe(this.picker.datepicker,2))},this.dateKeyListener=e=>{switch(e.preventDefault(),e.key){case"ArrowLeft":this.inputField.focus(),this.inputField.dispatchEvent(new KeyboardEvent("keydown",{key:"ArrowLeft"}));break;case"ArrowRight":this.inputField.focus(),this.inputField.dispatchEvent(new KeyboardEvent("keydown",{key:"ArrowRight"}));break;case"ArrowUp":this.inputField.focus(),this.inputField.dispatchEvent(new KeyboardEvent("keydown",{key:"ArrowUp"}));break;case"ArrowDown":this.inputField.focus(),this.inputField.dispatchEvent(new KeyboardEvent("keydown",{key:"ArrowDown"}));break;case"Enter":this.inputField.focus(),this.inputField.dispatchEvent(new KeyboardEvent("keydown",{key:"Enter"}));break;case"Escape":this.inputField.focus(),this.inputField.dispatchEvent(new KeyboardEvent("keydown",{key:"Escape"}));break;case"Tab":if(e.shiftKey){this.picker.controls.nextBtn.focus();break}this.picker.controls.prevBtn.focus()}}}init(e,t=!0){t&&(this.grid=this.element,this.element.classList.add("months","datepicker-grid"),this.grid.appendChild(O(c("span",12,{"data-month":e=>e})))),super.init(e)}setOptions(e){if(e.locale&&(this.monthNames=e.locale.monthsShort),s(e,"minDate"))if(void 0===e.minDate)this.minYear=this.minMonth=this.minDate=void 0;else{const t=new Date(e.minDate);this.minYear=t.getFullYear(),this.minMonth=t.getMonth(),this.minDate=t.setDate(1)}if(s(e,"maxDate"))if(void 0===e.maxDate)this.maxYear=this.maxMonth=this.maxDate=void 0;else{const t=new Date(e.maxDate);this.maxYear=t.getFullYear(),this.maxMonth=t.getMonth(),this.maxDate=p(this.maxYear,this.maxMonth+1,0)}this.isMinView?e.datesDisabled&&(this.datesDisabled=e.datesDisabled):this.datesDisabled=[],void 0!==e.beforeShowMonth&&(this.beforeShow="function"==typeof e.beforeShowMonth?e.beforeShowMonth:void 0)}updateFocus(){const e=new Date(this.picker.viewDate);this.year=e.getFullYear(),this.focused=e.getMonth()}updateSelection(){const{dates:e,rangepicker:t}=this.picker.datepicker;this.selected=e.reduce(((e,t)=>{const i=new Date(t),s=i.getFullYear(),n=i.getMonth();return void 0===e[s]?e[s]=[n]:r(e[s],n),e}),{}),t&&t.dates&&(this.range=t.dates.map((e=>{const t=new Date(e);return isNaN(t)?void 0:[t.getFullYear(),t.getMonth()]})))}render(){this.disabled=this.datesDisabled.reduce(((e,t)=>{const i=new Date(t);return this.year===i.getFullYear()&&e.push(i.getMonth()),e}),[]),this.picker.setViewSwitchLabel(this.year),this.picker.setPrevBtnDisabled(this.year<=this.minYear),this.picker.setNextBtnDisabled(this.year>=this.maxYear),this.picker.controls.prevBtn.setAttribute("aria-label",this.picker.datepicker.config.locale.btnPrevYear),this.picker.controls.nextBtn.setAttribute("aria-label",this.picker.datepicker.config.locale.btnNextYear),this.picker.controls.viewSwitch.setAttribute("aria-label",this.picker.datepicker.config.locale.btnYear);const s=this.selected[this.year]||[],n=this.year<this.minYear||this.year>this.maxYear,r=this.year===this.minYear,a=this.year===this.maxYear,o=ae(this.range,this.year);Array.from(this.grid.children).forEach(((d,c)=>{const l=d.classList,h=p(this.year,c,1);if(d.className=`datepicker-cell ${this.cellClass}`,this.isMinView&&(d.dataset.date=h),d.textContent=this.monthNames[c],(n||r&&c<this.minMonth||a&&c>this.maxMonth||this.disabled.includes(c))&&l.add("disabled"),o){const[e,t]=o;c>e&&c<t&&l.add("range"),c===e&&l.add("range-start"),c===t&&l.add("range-end")}s.includes(c)&&l.add("selected"),c===this.focused&&(l.add("focused"),d.setAttribute("tabindex","0"),d.focus(),t&&(this.picker.controls.prevBtn.focus(),t=!1),i&&(this.picker.controls.nextBtn.focus(),i=!1),d.addEventListener("keydown",this.dateKeyListener),this.picker.controls.prevBtn.addEventListener("keydown",this.prevBtnListener),e.push([this.picker.controls.prevBtn,"keydown",this.prevBtnListener]),this.picker.controls.viewSwitch.addEventListener("keydown",this.viewSwitchListener),e.push([this.picker.controls.viewSwitch,"keydown",this.viewSwitchListener]),this.picker.controls.nextBtn.addEventListener("keydown",this.nextBtnListener),e.push([this.picker.controls.nextBtn,"keydown",this.nextBtnListener])),this.beforeShow&&this.performBeforeHook(d,c,h)}))}refresh(){const e=this.selected[this.year]||[],[t,i]=ae(this.range,this.year)||[];this.grid.querySelectorAll(".range, .range-start, .range-end, .selected, .focused").forEach((e=>{e.classList.remove("range","range-start","range-end","selected","focused")})),Array.from(this.grid.children).forEach(((s,n)=>{const r=s.classList;n>t&&n<i&&r.add("range"),n===t&&r.add("range-start"),n===i&&r.add("range-end"),e.includes(n)&&r.add("selected"),n===this.focused&&r.add("focused")}))}refreshFocus(){this.grid.querySelectorAll(".focused").forEach((e=>{e.classList.remove("focused"),e.removeAttribute("tabindex"),e.removeEventListener("keydown",this.dateKeyListener)})),this.grid.children[this.focused].classList.add("focused"),this.grid.children[this.focused].setAttribute("tabindex","0"),this.grid.children[this.focused].focus(),this.grid.children[this.focused].addEventListener("keydown",this.dateKeyListener)}}class de extends ne{constructor(t,i){super(t,i),this.inputField=this.picker.datepicker.element,this.prevBtnListener=e=>{if("Tab"==e.key)if(e.preventDefault(),e.shiftKey){const e=Math.round((this.focused-this.start)/this.step);this.grid.children[e].focus()}else 2==this.id?this.picker.controls.viewSwitch.focus():this.picker.controls.nextBtn.focus();else"ArrowLeft"==e.key||"ArrowUp"==e.key||"ArrowDown"==e.key||"ArrowRight"==e.key?e.preventDefault():"Escape"==e.key&&(e.preventDefault(),this.picker.datepicker.inputField.focus(),this.picker.hide(),Pe(this.picker.datepicker,2))},this.viewSwitchListener=t=>{if("Tab"==t.key)t.preventDefault(),t.shiftKey?this.picker.controls.prevBtn.focus():this.picker.controls.nextBtn.focus();else if("Enter"==t.key&&3!=this.picker.currentView.id){for(let t=0;t<e.length;t++)e[t][0].removeEventListener(e[t][1],e[t][2]);e=[]}else"Escape"==t.key&&(t.preventDefault(),this.picker.datepicker.inputField.focus(),this.picker.hide(),Pe(this.picker.datepicker,2))},this.nextBtnListener=e=>{if("Tab"==e.key)if(e.preventDefault(),e.shiftKey)2==this.id?this.picker.controls.viewSwitch.focus():this.picker.controls.prevBtn.focus();else{const e=Math.round((this.focused-this.start)/this.step);this.grid.children[e].focus()}else"ArrowLeft"==e.key||"ArrowUp"==e.key||"ArrowDown"==e.key||"ArrowRight"==e.key?e.preventDefault():"Escape"==e.key&&(e.preventDefault(),this.picker.datepicker.inputField.focus(),this.picker.hide(),Pe(this.picker.datepicker,2))},this.dateKeyListener=e=>{switch(e.preventDefault(),e.key){case"ArrowLeft":this.inputField.focus(),this.inputField.dispatchEvent(new KeyboardEvent("keydown",{key:"ArrowLeft"}));break;case"ArrowRight":this.inputField.focus(),this.inputField.dispatchEvent(new KeyboardEvent("keydown",{key:"ArrowRight"}));break;case"ArrowUp":this.inputField.focus(),this.inputField.dispatchEvent(new KeyboardEvent("keydown",{key:"ArrowUp"}));break;case"ArrowDown":this.inputField.focus(),this.inputField.dispatchEvent(new KeyboardEvent("keydown",{key:"ArrowDown"}));break;case"Enter":this.inputField.focus(),this.inputField.dispatchEvent(new KeyboardEvent("keydown",{key:"Enter"}));break;case"Escape":this.inputField.focus(),this.inputField.dispatchEvent(new KeyboardEvent("keydown",{key:"Escape"}));break;case"Tab":if(e.shiftKey){this.picker.controls.nextBtn.focus();break}this.picker.controls.prevBtn.focus()}}}init(e,t=!0){var i;t&&(this.navStep=10*this.step,this.beforeShowOption=`beforeShow${i=this.cellClass,[...i].reduce(((e,t,i)=>e+(i?t:t.toUpperCase())),"")}`,this.grid=this.element,this.element.classList.add(this.name,"datepicker-grid"),this.grid.appendChild(O(c("span",12)))),super.init(e)}setOptions(e){if(s(e,"minDate")&&(void 0===e.minDate?this.minYear=this.minDate=void 0:(this.minYear=v(e.minDate,this.step),this.minDate=p(this.minYear,0,1))),s(e,"maxDate")&&(void 0===e.maxDate?this.maxYear=this.maxDate=void 0:(this.maxYear=v(e.maxDate,this.step),this.maxDate=p(this.maxYear,11,31))),this.isMinView?e.datesDisabled&&(this.datesDisabled=e.datesDisabled):this.datesDisabled=[],void 0!==e[this.beforeShowOption]){const t=e[this.beforeShowOption];this.beforeShow="function"==typeof t?t:void 0}}updateFocus(){const e=new Date(this.picker.viewDate),t=v(e,this.navStep),i=t+9*this.step;this.first=t,this.last=i,this.start=t-this.step,this.focused=v(e,this.step)}updateSelection(){const{dates:e,rangepicker:t}=this.picker.datepicker;this.selected=e.reduce(((e,t)=>r(e,v(t,this.step))),[]),t&&t.dates&&(this.range=t.dates.map((e=>{if(void 0!==e)return v(e,this.step)})))}render(){switch(this.disabled=this.datesDisabled.map((e=>new Date(e).getFullYear())),this.picker.setViewSwitchLabel(`${this.first}-${this.last}`),this.picker.setPrevBtnDisabled(this.first<=this.minYear),this.picker.setNextBtnDisabled(this.last>=this.maxYear),this.id){case 2:this.picker.controls.prevBtn.setAttribute("aria-label",this.picker.datepicker.config.locale.btnPrevDecade),this.picker.controls.nextBtn.setAttribute("aria-label",this.picker.datepicker.config.locale.btnNextDecade),this.picker.controls.viewSwitch.setAttribute("aria-label",this.picker.datepicker.config.locale.btnDecade);break;case 3:this.picker.controls.prevBtn.setAttribute("aria-label",this.picker.datepicker.config.locale.btnPrevCentury),this.picker.controls.nextBtn.setAttribute("aria-label",this.picker.datepicker.config.locale.btnNextCentury),this.picker.controls.viewSwitch.removeAttribute("aria-label")}Array.from(this.grid.children).forEach(((s,n)=>{const r=s.classList,a=this.start+n*this.step,o=p(a,0,1);if(s.className=`datepicker-cell ${this.cellClass}`,this.isMinView&&(s.dataset.date=o),s.textContent=s.dataset.year=a,0===n?r.add("prev"):11===n&&r.add("next"),(a<this.minYear||a>this.maxYear||this.disabled.includes(a))&&r.add("disabled"),this.range){const[e,t]=this.range;a>e&&a<t&&r.add("range"),a===e&&r.add("range-start"),a===t&&r.add("range-end")}this.selected.includes(a)&&r.add("selected"),a===this.focused&&(r.add("focused"),s.setAttribute("tabindex","0"),s.focus(),t&&(this.picker.controls.prevBtn.focus(),t=!1),i&&(this.picker.controls.nextBtn.focus(),i=!1),s.addEventListener("keydown",this.dateKeyListener),this.picker.controls.prevBtn.addEventListener("keydown",this.prevBtnListener),e.push([this.picker.controls.prevBtn,"keydown",this.prevBtnListener]),this.picker.controls.viewSwitch.addEventListener("keydown",this.viewSwitchListener),e.push([this.picker.controls.viewSwitch,"keydown",this.viewSwitchListener]),this.picker.controls.nextBtn.addEventListener("keydown",this.nextBtnListener),e.push([this.picker.controls.nextBtn,"keydown",this.nextBtnListener])),this.beforeShow&&this.performBeforeHook(s,a,o)}))}refresh(){const[e,t]=this.range||[];this.grid.querySelectorAll(".range, .range-start, .range-end, .selected, .focused").forEach((e=>{e.classList.remove("range","range-start","range-end","selected","focused")})),Array.from(this.grid.children).forEach((i=>{const s=Number(i.textContent),n=i.classList;s>e&&s<t&&n.add("range"),s===e&&n.add("range-start"),s===t&&n.add("range-end"),this.selected.includes(s)&&n.add("selected"),s===this.focused&&n.add("focused")}))}refreshFocus(){const e=Math.round((this.focused-this.start)/this.step);this.grid.querySelectorAll(".focused").forEach((e=>{e.classList.remove("focused"),e.removeAttribute("tabindex"),e.removeEventListener("keydown",this.dateKeyListener)})),this.grid.children[e].classList.add("focused"),this.grid.children[e].setAttribute("tabindex","0"),this.grid.children[e].focus(),this.grid.children[e].addEventListener("keydown",this.dateKeyListener)}}function ce(e,t,i=!1){const s={date:e.getDate(),viewDate:new Date(e.picker.viewDate),viewId:e.picker.currentView.id,datepicker:e,type:t};"changeDate"===t&&e.element.dispatchEvent(new CustomEvent(t,{bubbles:!1})),e.element.dispatchEvent(new CustomEvent("sirioWebKit",{bubbles:i,detail:s}))}function le(e,t){const{minDate:i,maxDate:s}=e.config,{currentView:n,viewDate:r}=e.picker;let a;switch(n.id){case 0:a=k(r,t);break;case 1:a=w(r,t);break;default:a=w(r,t*n.navStep)}a=d(a,i,s),e.picker.changeFocus(a).render()}function he(e){const t=e.picker.currentView.id;t!==e.config.maxView&&e.picker.changeView(t+1).render()}function ue(t){t.config.updateOnBlur?t.update({revert:!0}):t.refresh("input"),t.hide();for(let t=0;t<e.length;t++)e[t][0].removeEventListener(e[t][1],e[t][2]);e=[]}function pe(e,t){const i=e.picker,s=new Date(i.viewDate),n=i.currentView.id,r=1===n?k(s,t-s.getMonth()):w(s,t-s.getFullYear());i.changeFocus(r).changeView(n-1).render()}function fe(e){const t=e.picker,i=u();if(1===e.config.todayBtnMode){if(e.config.autohide)return void e.setDate(i);e.setDate(i,{render:!1}),t.update()}t.viewDate!==i&&t.changeFocus(i),t.changeView(0).render()}function ke(e){e.setDate({clear:!0})}function we(e){he(e)}function ye(e){t=!0,le(e,-1)}function ge(e){i=!0,le(e,1)}function ve(e,t){const i=_(t,".datepicker-cell");if(!i||i.classList.contains("disabled"))return;const{id:s,isMinView:n}=e.picker.currentView;n?e.setDate(Number(i.dataset.date)):pe(e,Number(1===s?i.dataset.month:i.dataset.year))}function be(e){e.preventDefault()}const me=["left","top","right","bottom"].reduce(((e,t)=>(e[t]=`datepicker-orient-${t}`,e)),{}),De=e=>e?`${e}px`:e;function xe(e,t){if(void 0!==t.title&&(t.title?(e.controls.title.textContent=t.title,W(e.controls.title)):(e.controls.title.textContent="",V(e.controls.title))),t.prevArrow){const i=e.controls.prevBtn;Y(i),t.prevArrow.forEach((e=>{i.appendChild(e.cloneNode(!0))}))}if(t.nextArrow){const i=e.controls.nextBtn;Y(i),t.nextArrow.forEach((e=>{i.appendChild(e.cloneNode(!0))}))}if(t.locale&&(e.controls.todayBtn.textContent=t.locale.today,e.controls.clearBtn.textContent=t.locale.clear),void 0!==t.todayBtn&&(t.todayBtn?W(e.controls.todayBtn):V(e.controls.todayBtn)),s(t,"minDate")||s(t,"maxDate")){const{minDate:t,maxDate:i}=e.datepicker.config;e.controls.todayBtn.disabled=!o(u(),t,i)}void 0!==t.clearBtn&&(t.clearBtn?W(e.controls.clearBtn):V(e.controls.clearBtn))}function Ee(e){const{dates:t,config:i}=e;return d(t.length>0?n(t):i.defaultViewDate,i.minDate,i.maxDate)}function Le(e,t){const i=new Date(e.viewDate),s=new Date(t),{id:n,year:r,first:a,last:o}=e.currentView,d=s.getFullYear();switch(e.viewDate=t,d!==i.getFullYear()&&ce(e.datepicker,"changeYear"),s.getMonth()!==i.getMonth()&&ce(e.datepicker,"changeMonth"),n){case 0:return t<a||t>o;case 1:return d!==r;default:return d<a||d>o}}function Se(e){return window.getComputedStyle(e).direction}function Ae(e){const t=N(e);if(t!==document.body&&t)return"visible"!==window.getComputedStyle(t).overflow?t:Ae(t)}class Me{constructor(e){const{config:t}=this.datepicker=e,i=te.replace(/%buttonClass%/g,t.buttonClass),s=this.element=O(i).firstChild,[n,r,a]=s.firstChild.children,o=n.firstElementChild,[d,c,l]=n.lastElementChild.children,[h,u]=a.firstChild.children,p={title:o,prevBtn:d,viewSwitch:c,nextBtn:l,todayBtn:h,clearBtn:u};this.main=r,this.controls=p;const f=e.inline?"inline":"dropdown";s.classList.add(`datepicker-${f}`),xe(this,t),this.viewDate=Ee(e),H(e,[[s,"mousedown",be],[r,"click",ve.bind(null,e)],[p.viewSwitch,"click",we.bind(null,e)],[p.prevBtn,"click",ye.bind(null,e)],[p.nextBtn,"click",ge.bind(null,e)],[p.todayBtn,"click",fe.bind(null,e)],[p.clearBtn,"click",ke.bind(null,e)]]),this.views=[new re(this),new oe(this),new de(this,{id:2,name:"years",cellClass:"year",step:1}),new de(this,{id:3,name:"decades",cellClass:"decade",step:10})],this.currentView=this.views[t.startView],this.currentView.render(),this.main.appendChild(this.currentView.element),t.container?t.container.appendChild(this.element):e.inputField.after(this.element)}setOptions(e){xe(this,e),this.views.forEach((t=>{t.init(e,!1)})),this.currentView.render()}detach(){this.element.remove()}show(){if(this.active)return;const{datepicker:e,element:t}=this;for(let t=0;t<e.picker.views.length;t++)0==e.picker.views[t].id&&e.picker.views[t].updateControlsListeners();if(e.inline)t.classList.add("active");else{const i=Se(e.inputField);i!==Se(N(t))?t.dir=i:t.dir&&t.removeAttribute("dir"),t.style.visiblity="hidden",t.classList.add("active"),this.place(),t.style.visiblity="",e.config.disableTouchKeyboard&&e.inputField.blur()}this.active=!0,ce(e,"show")}hide(){this.active&&(this.datepicker.exitEditMode(),this.element.classList.remove("active"),this.active=!1,ce(this.datepicker,"hide"))}place(){const{classList:e,offsetParent:t,style:i}=this.element,{config:s,inputField:n}=this.datepicker,{width:r,height:a}=this.element.getBoundingClientRect(),{left:o,top:d,right:c,bottom:l,width:h,height:u}=n.getBoundingClientRect();let{x:p,y:f}=s.orientation,k=o,w=d;if(t!==document.body&&t){const e=t.getBoundingClientRect();k-=e.left-t.scrollLeft,w-=e.top-t.scrollTop}else k+=window.scrollX,w+=window.scrollY;const y=Ae(n);let g=0,v=0,{clientWidth:b,clientHeight:m}=document.documentElement;if(y){const e=y.getBoundingClientRect();e.top>0&&(v=e.top),e.left>0&&(g=e.left),e.right<b&&(b=e.right),e.bottom<m&&(m=e.bottom)}let D=0;"auto"===p&&(o<g?(p="left",D=g-o):o+r>b?(p="right",b<c&&(D=b-c)):p="rtl"===Se(n)?c-r<g?"left":"right":"left"),"right"===p&&(k+=h-r),k+=D,"auto"===f&&(f=d-a>v&&l+a>m?"top":"bottom"),"top"===f?w-=a:w+=u,e.remove(...Object.values(me)),e.add(me[p],me[f]),i.left=De(k),i.top=De(w)}setViewSwitchLabel(e){this.controls.viewSwitch.textContent=e}setPrevBtnDisabled(e){this.controls.prevBtn.disabled=e}setNextBtnDisabled(e){this.controls.nextBtn.disabled=e}changeView(e){const t=this.currentView,i=this.views[e];return i.id!==t.id&&(this.currentView=i,this._renderMethod="render",ce(this.datepicker,"changeView"),this.main.replaceChild(i.element,t.element)),this}changeFocus(e){return this._renderMethod=Le(this,e)?"render":"refreshFocus",this.views.forEach((e=>{e.updateFocus()})),this}update(){const e=Ee(this.datepicker);return this._renderMethod=Le(this,e)?"render":"refresh",this.views.forEach((e=>{e.updateFocus(),e.updateSelection()})),this}render(e=!0){const t=e&&this._renderMethod||"render";delete this._renderMethod,this.currentView[t]()}}function Fe(e,t,i,s,n,r){if(o(e,n,r)){if(s(e)){return Fe(t(e,i),t,i,s,n,r)}return e}}function Be(e,t,i,s){const n=e.picker,r=n.currentView,a=r.step||1;let o,d,c=n.viewDate;switch(r.id){case 0:c=s?f(c,7*i):t.ctrlKey||t.metaKey?w(c,i):f(c,i),o=f,d=e=>r.disabled.includes(e);break;case 1:c=k(c,s?3*i:i),o=k,d=e=>{const t=new Date(e),{year:i,disabled:s}=r;return t.getFullYear()===i&&s.includes(t.getMonth())};break;default:c=w(c,i*(s?3:1)*a),o=w,d=e=>r.disabled.includes(v(e,a))}c=Fe(c,o,i<0?-a:a,d,r.minDate,r.maxDate),void 0!==c&&n.changeFocus(c).render()}function Ce(e,t){const i=t.key;if("Tab"===i)return void ue(e);const s=e.picker,{id:n,isMinView:r}=s.currentView;if(s.active){if(e.editMode)return void("Enter"===i?e.exitEditMode({update:!0,autohide:e.config.autohide}):"Escape"===i&&s.hide());if("ArrowLeft"===i)if(t.ctrlKey||t.metaKey)le(e,-1);else{if(t.shiftKey)return void e.enterEditMode();Be(e,t,-1,!1)}else if("ArrowRight"===i)if(t.ctrlKey||t.metaKey)le(e,1);else{if(t.shiftKey)return void e.enterEditMode();Be(e,t,1,!1)}else if("ArrowUp"===i)if(t.ctrlKey||t.metaKey)he(e);else{if(t.shiftKey)return void e.enterEditMode();Be(e,t,-1,!0)}else if("ArrowDown"===i){if(t.shiftKey&&!t.ctrlKey&&!t.metaKey)return void e.enterEditMode();Be(e,t,1,!0)}else{if("Enter"!==i)return void("Escape"===i?s.hide():"Backspace"!==i&&"Delete"!==i&&(1!==i.length||t.ctrlKey||t.metaKey)||e.enterEditMode());if(r)return void e.setDate(s.viewDate);s.changeView(n-1).render()}}else{if("ArrowDown"!==i)return void("Enter"===i?e.update():"Escape"===i&&s.show());s.show()}t.preventDefault()}function Oe(e){e.config.showOnFocus&&!e._showing&&e.show()}function Ne(e,t){const i=t.target;(e.picker.active||e.config.showOnClick)&&(i._active=K(i),i._clicking=setTimeout((()=>{delete i._active,delete i._clicking}),2e3))}function Ke(e,t){const i=t.target;i._clicking&&(clearTimeout(i._clicking),delete i._clicking,i._active&&e.enterEditMode(),delete i._active,e.config.showOnClick&&e.show())}function Ve(e,t){t.clipboardData.types.includes("text/plain")&&e.enterEditMode()}function We(e,t){const{element:i,picker:s}=e;if(!s.active&&!K(i))return;const n=s.element;_(t,(e=>e===i||e===n))||ue(e)}function Ye(e,t){return e.map((e=>B(e,t.format,t.locale))).join(t.dateDelimiter)}function Te(e,t,i=!1){const{config:s,dates:n,rangeSideIndex:r}=e;if(0===t.length)return i?[]:void 0;let a=t.reduce(((e,t)=>{let i=F(t,s.format,s.locale);return void 0===i||(i=b(i,s.pickLevel,r),!o(i,s.minDate,s.maxDate)||e.includes(i)||s.datesDisabled.includes(i)||!(s.pickLevel>0)&&s.daysOfWeekDisabled.includes(new Date(i).getDay())||e.push(i)),e}),[]);return 0!==a.length?(s.multidate&&!i&&(a=a.reduce(((e,t)=>(n.includes(t)||e.push(t),e)),n.filter((e=>!a.includes(e))))),s.maxNumberOfDates&&a.length>s.maxNumberOfDates?a.slice(-1*s.maxNumberOfDates):a):void 0}function Pe(e,t=3,i=!0){const{config:s,picker:n,inputField:r}=e;if(2&t){const e=n.active?s.pickLevel:s.startView;n.update().changeView(e).render(i)}1&t&&r&&(r.value=Ye(e.dates,s))}function Re(e,t,i){let{clear:s,render:n,autohide:r,revert:a}=i;void 0===n&&(n=!0),n?void 0===r&&(r=e.config.autohide):r=!1;const o=Te(e,t,s);(o||a)&&(o&&o.toString()!==e.dates.toString()?(e.dates=o,Pe(e,n?3:1),ce(e,"changeDate")):Pe(e,1),r&&e.hide())}class He{constructor(e,t={},i=void 0){e.datepicker=this,this.element=e;const s=this.config=Object.assign({buttonClass:t.buttonClass&&String(t.buttonClass)||"button",container:null,defaultViewDate:u(),maxDate:void 0,minDate:void 0},ee(I,this)),n=this.inline="INPUT"!==e.tagName;let r,o;if(n?s.container=e:(t.container&&(s.container=t.container instanceof HTMLElement?t.container:document.querySelector(t.container)),r=this.inputField=e,r.classList.add("datepicker-input")),i){const e=i.inputs.indexOf(r),t=i.datepickers;if(e<0||e>1||!Array.isArray(t))throw Error("Invalid rangepicker object.");t[e]=this,Object.defineProperty(this,"rangepicker",{get:()=>i}),Object.defineProperty(this,"rangeSideIndex",{get:()=>e})}this._options=t,Object.assign(s,ee(t,this)),n?(o=a(e.dataset.date,s.dateDelimiter),delete e.dataset.date):o=a(r.value,s.dateDelimiter),this.dates=[];const d=Te(this,o);d&&d.length>0&&(this.dates=d),r&&(r.value=Ye(this.dates,s));const c=this.picker=new Me(this);if(n)this.show();else{const e=We.bind(null,this);H(this,[[r,"keydown",Ce.bind(null,this)],[r,"focus",Oe.bind(null,this)],[r,"mousedown",Ne.bind(null,this)],[r,"click",Ke.bind(null,this)],[r,"paste",Ve.bind(null,this)],[document,"mousedown",e],[document,"touchstart",e],[window,"resize",c.place.bind(c)]])}}static formatDate(e,t,i){return B(e,t,i&&U[i]||U.en)}static parseDate(e,t,i){return F(e,t,i&&U[i]||U.en)}static get locales(){return U}get active(){return!(!this.picker||!this.picker.active)}get pickerElement(){return this.picker?this.picker.element:void 0}setOptions(e){const t=this.picker,i=ee(e,this);Object.assign(this._options,e),Object.assign(this.config,i),t.setOptions(i),Pe(this,3)}show(){if(this.inputField){if(this.inputField.disabled)return;K(this.inputField)||this.config.disableTouchKeyboard||(this._showing=!0,this.inputField.focus(),delete this._showing)}this.picker.show()}hide(){this.inline||(this.picker.hide(),this.picker.update().changeView(this.config.startView).render())}destroy(){return this.hide(),j(this),this.picker.detach(),this.inline||this.inputField.classList.remove("datepicker-input"),delete this.element.datepicker,this}getDate(e=void 0){const t=e?t=>B(t,e,this.config.locale):e=>new Date(e);return this.config.multidate?this.dates.map(t):this.dates.length>0?t(this.dates[0]):void 0}setDate(...e){const t=[...e],i={},s=n(e);"object"!=typeof s||Array.isArray(s)||s instanceof Date||!s||Object.assign(i,t.pop());Re(this,Array.isArray(t[0])?t[0]:t,i),ce(this,"change",!0)}update(e=void 0){if(this.inline)return;const t=Object.assign(e||{},{clear:!0,render:!0});Re(this,a(this.inputField.value,this.config.dateDelimiter),t)}refresh(e=void 0,t=!1){let i;e&&"string"!=typeof e&&(t=e,e=void 0),i="picker"===e?2:"input"===e?1:3,Pe(this,i,!t)}enterEditMode(){this.inline||!this.picker.active||this.editMode||(this.editMode=!0,this.inputField.classList.add("in-edit"))}exitEditMode(e=void 0){if(this.inline||!this.editMode)return;const t=Object.assign({update:!1},e);delete this.editMode,this.inputField.classList.remove("in-edit"),t.update&&this.update(t)}}function je(e){const t=Object.assign({},e);return delete t.inputs,delete t.allowOneSidedRange,delete t.maxNumberOfDates,t}function $e(e,t,i,s){H(e,[[i,"changeDate",t]]);try{new He(i,s,e)}catch(e){}}function _e(e,t){if(e._updating)return;e._updating=!0;const i=t.target;if(void 0===i.datepicker)return;const s=e.datepickers,n={render:!1},r=e.inputs.indexOf(i),a=0===r?1:0,o=s[r].dates[0],d=s[a].dates[0];void 0!==o&&void 0!==d?0===r&&o>d?(s[0].setDate(d,n),s[1].setDate(o,n)):1===r&&o<d&&(s[0].setDate(o,n),s[1].setDate(d,n)):e.allowOneSidedRange||void 0===o&&void 0===d||(n.clear=!0,s[a].setDate(s[r].dates,n)),s[0].picker.update().render(),s[1].picker.update().render(),delete e._updating}window.Datepicker=He,window.DateRangePicker=class{constructor(e,t={}){const i=Array.isArray(t.inputs)?t.inputs:Array.from(e.querySelectorAll("input"));if(i.length<2)return;e.rangepicker=this,this.element=e,this.inputs=i.slice(0,2),this.allowOneSidedRange=!!t.allowOneSidedRange;const s=_e.bind(null,this),n=je(t),r=[];Object.defineProperty(this,"datepickers",{get:()=>r}),$e(this,s,this.inputs[0],n),$e(this,s,this.inputs[1],n),Object.freeze(r),r[0].dates.length>0?_e(this,{target:this.inputs[0]}):r[1].dates.length>0&&_e(this,{target:this.inputs[1]})}get dates(){return 2===this.datepickers.length?[this.datepickers[0].dates[0],this.datepickers[1].dates[0]]:void 0}setOptions(e){this.allowOneSidedRange=!!e.allowOneSidedRange;const t=je(e);this.datepickers[0].setOptions(t),this.datepickers[1].setOptions(t)}destroy(){this.datepickers[0].destroy(),this.datepickers[1].destroy(),j(this),delete this.element.rangepicker}getDates(e=void 0){const t=e?t=>B(t,e,this.datepickers[0].config.locale):e=>new Date(e);return this.dates.map((e=>void 0===e?e:t(e)))}setDates(e,t){const[i,s]=this.datepickers,n=this.dates;this._updating=!0,i.setDate(e),s.setDate(t),delete this._updating,s.dates[0]!==n[1]?_e(this,{target:this.inputs[1]}):i.dates[0]!==n[0]&&_e(this,{target:this.inputs[0]})}}}();